import{r as C,j as e}from"./jsx-runtime-D1yySo7E.js";import{z as s}from"./index-BeXw7Xwl.js";import{E as F}from"./forms-O3akMyig.js";import{B as P}from"./button-xs8ZcSgc.js";import{I as n}from"./icon-CC3MP7l8.js";import{S as N}from"./status-button-Bx4F4H9E.js";import{b as D,u as w,g as E}from"./misc-CxaYal_B.js";import{b as z,a as A}from"./components-C2HTMhgG.js";import{c as k,F as L}from"./index-CcD7lzrX.js";import{u as T,g as U,a as Z}from"./helpers-CMO8ncdm.js";import{g as q}from"./constraint-BS8S8JXD.js";import{p as M}from"./parse-Cj2OtakU.js";import"./index-ikwP-usE.js";import"./index-DbU3sxCe.js";import"./label-Bak8eTW5.js";import"./tooltip-wwqaYhkn.js";const le={breadcrumb:e.jsx(n,{name:"avatar",children:"Photo"}),getSitemapEntries:()=>null},O=1024*1024*3,V=s.object({intent:s.literal("delete")}),W=s.object({intent:s.literal("submit"),photoFile:s.instanceof(File).refine(t=>t.size>0,"Image is required").refine(t=>t.size<=O,"Image size must be less than 3MB")}),R=s.discriminatedUnion("intent",[V,W]);function me(){var p,h,g,f,x;const t=z(),l=D(),a=A(),y=k(),[r,i]=T({id:"profile-photo",constraint:q(R),lastResult:a==null?void 0:a.result,onValidate({formData:o}){return M(o,{schema:R})},shouldRevalidate:"onBlur"}),m=w()?(p=y.formData)==null?void 0:p.get("intent"):null,d=i.intent.value,[u,c]=C.useState(null);return e.jsx("div",{children:e.jsxs(L,{method:"POST",encType:"multipart/form-data",className:"flex flex-col items-center justify-center gap-10",onReset:()=>c(null),...U(r),children:[e.jsx("img",{src:u??(t.user?E((h=t.user.image)==null?void 0:h.id):""),className:"h-52 w-52 rounded-full object-cover",alt:((g=t.user)==null?void 0:g.name)??((f=t.user)==null?void 0:f.username)}),e.jsx(F,{errors:i.photoFile.errors,id:i.photoFile.id}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{...Z(i.photoFile,{type:"file"}),accept:"image/*",className:"peer sr-only",required:!0,tabIndex:u?-1:0,onChange:o=>{var b;const j=(b=o.currentTarget.files)==null?void 0:b[0];if(j){const v=new FileReader;v.onload=B=>{var I,S;c(((S=(I=B.target)==null?void 0:I.result)==null?void 0:S.toString())??null)},v.readAsDataURL(j)}}}),e.jsx(P,{asChild:!0,className:"cursor-pointer peer-valid:hidden peer-focus-within:ring-2 peer-focus-visible:ring-2",children:e.jsx("label",{htmlFor:i.photoFile.id,children:e.jsx(n,{name:"pencil-1",children:"Change"})})}),e.jsx(N,{name:"intent",value:"submit",type:"submit",className:"peer-invalid:hidden",status:m==="submit"?"pending":d==="submit"?r.status??"idle":"idle",children:"Save Photo"}),e.jsx(P,{variant:"destructive",className:"peer-invalid:hidden",...r.reset.getButtonProps(),children:e.jsx(n,{name:"trash",children:"Reset"})}),(x=t.user.image)!=null&&x.id?e.jsx(N,{className:"peer-valid:hidden",variant:"destructive",...l.getButtonProps({type:"submit",name:"intent",value:"delete"}),status:m==="delete"?"pending":d==="delete"?r.status??"idle":"idle",children:e.jsx(n,{name:"trash",children:l.doubleCheck?"Are you sure?":"Delete"})}):null]}),e.jsx(F,{errors:r.errors})]})})}export{me as default,le as handle};
//# sourceMappingURL=profile.photo-DqOBFlUA.js.map
