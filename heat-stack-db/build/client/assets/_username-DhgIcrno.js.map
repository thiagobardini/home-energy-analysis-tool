{"version":3,"file":"_username-DhgIcrno.js","sources":["../../../app/routes/users+/$username.tsx"],"sourcesContent":["import { invariantResponse } from '@epic-web/invariant'\nimport { json, type LoaderFunctionArgs } from '@remix-run/node'\nimport { Form, Link, useLoaderData, type MetaFunction } from '@remix-run/react'\nimport { GeneralErrorBoundary } from '#app/components/error-boundary.tsx'\nimport { Spacer } from '#app/components/spacer.tsx'\nimport { Button } from '#app/components/ui/button.tsx'\nimport { Icon } from '#app/components/ui/icon.tsx'\nimport { prisma } from '#app/utils/db.server.ts'\nimport { getUserImgSrc } from '#app/utils/misc.tsx'\nimport { useOptionalUser } from '#app/utils/user.ts'\n\nexport async function loader({ params }: LoaderFunctionArgs) {\n\tconst user = await prisma.user.findFirst({\n\t\tselect: {\n\t\t\tid: true,\n\t\t\tname: true,\n\t\t\tusername: true,\n\t\t\tcreatedAt: true,\n\t\t\timage: { select: { id: true } },\n\t\t},\n\t\twhere: {\n\t\t\tusername: params.username,\n\t\t},\n\t})\n\n\tinvariantResponse(user, 'User not found', { status: 404 })\n\n\treturn json({ user, userJoinedDisplay: user.createdAt.toLocaleDateString() })\n}\n\nexport default function ProfileRoute() {\n\tconst data = useLoaderData<typeof loader>()\n\tconst user = data.user\n\tconst userDisplayName = user.name ?? user.username\n\tconst loggedInUser = useOptionalUser()\n\tconst isLoggedInUser = data.user.id === loggedInUser?.id\n\n\treturn (\n\t\t<div className=\"container mb-48 mt-36 flex flex-col items-center justify-center\">\n\t\t\t<Spacer size=\"4xs\" />\n\n\t\t\t<div className=\"container flex flex-col items-center rounded-3xl bg-muted p-12\">\n\t\t\t\t<div className=\"relative w-52\">\n\t\t\t\t\t<div className=\"absolute -top-40\">\n\t\t\t\t\t\t<div className=\"relative\">\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tsrc={getUserImgSrc(data.user.image?.id)}\n\t\t\t\t\t\t\t\talt={userDisplayName}\n\t\t\t\t\t\t\t\tclassName=\"h-52 w-52 rounded-full object-cover\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<Spacer size=\"sm\" />\n\n\t\t\t\t<div className=\"flex flex-col items-center\">\n\t\t\t\t\t<div className=\"flex flex-wrap items-center justify-center gap-4\">\n\t\t\t\t\t\t<h1 className=\"text-center text-h2\">{userDisplayName}</h1>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p className=\"mt-2 text-center text-muted-foreground\">\n\t\t\t\t\t\tJoined {data.userJoinedDisplay}\n\t\t\t\t\t</p>\n\t\t\t\t\t{isLoggedInUser ? (\n\t\t\t\t\t\t<Form action=\"/logout\" method=\"POST\" className=\"mt-3\">\n\t\t\t\t\t\t\t<Button type=\"submit\" variant=\"link\" size=\"pill\">\n\t\t\t\t\t\t\t\t<Icon name=\"exit\" className=\"scale-125 max-md:scale-150\">\n\t\t\t\t\t\t\t\t\tLogout\n\t\t\t\t\t\t\t\t</Icon>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Form>\n\t\t\t\t\t) : null}\n\t\t\t\t\t<div className=\"mt-10 flex gap-4\">\n\t\t\t\t\t\t{isLoggedInUser ? (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<Button asChild>\n\t\t\t\t\t\t\t\t\t<Link to=\"notes\" prefetch=\"intent\">\n\t\t\t\t\t\t\t\t\t\tMy notes\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t<Button asChild>\n\t\t\t\t\t\t\t\t\t<Link to=\"/settings/profile\" prefetch=\"intent\">\n\t\t\t\t\t\t\t\t\t\tEdit profile\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<Button asChild>\n\t\t\t\t\t\t\t\t<Link to=\"notes\" prefetch=\"intent\">\n\t\t\t\t\t\t\t\t\t{userDisplayName}'s notes\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport const meta: MetaFunction<typeof loader> = ({ data, params }) => {\n\tconst displayName = data?.user.name ?? params.username\n\treturn [\n\t\t{ title: `${displayName} | Epic Notes` },\n\t\t{\n\t\t\tname: 'description',\n\t\t\tcontent: `Profile of ${displayName} on Epic Notes`,\n\t\t},\n\t]\n}\n\nexport function ErrorBoundary() {\n\treturn (\n\t\t<GeneralErrorBoundary\n\t\t\tstatusHandlers={{\n\t\t\t\t404: ({ params }) => (\n\t\t\t\t\t<p>No user with the username \"{params.username}\" exists</p>\n\t\t\t\t),\n\t\t\t}}\n\t\t/>\n\t)\n}\n"],"names":["ProfileRoute","data","useLoaderData","user","userDisplayName","name","username","loggedInUser","useOptionalUser","isLoggedInUser","id","jsxs","className","children","jsx","Spacer","size","src","getUserImgSrc","image","alt","userJoinedDisplay","Form","action","method","Button","type","variant","Icon","Fragment","asChild","Link","to","prefetch","meta","params","displayName","title","content","ErrorBoundary","GeneralErrorBoundary","statusHandlers"],"mappings":"4bA8BA,SAAwBA,GAAe,OACtC,MAAMC,EAAOC,IACPC,EAAOF,EAAKE,KACZC,EAAkBD,EAAKE,MAAQF,EAAKG,SACpCC,EAAeC,IACfC,EAAiBR,EAAKE,KAAKO,MAAOH,GAAAA,YAAAA,EAAcG,IAGrD,OAAAC,EAAAA,KAAC,MAAI,CAAAC,UAAU,kEACdC,SAAA,CAACC,EAAA,IAAAC,EAAA,CAAOC,KAAK,KAAM,CAAA,EAEnBL,EAAA,KAAC,MAAI,CAAAC,UAAU,iEACdC,SAAA,CAACC,EAAA,IAAA,MAAA,CAAIF,UAAU,gBACdC,SAACC,EAAA,IAAA,MAAA,CAAIF,UAAU,mBACdC,SAAAC,EAAA,IAAC,MAAI,CAAAF,UAAU,WACdC,SAAAC,EAAA,IAAC,MAAA,CACAG,IAAKC,GAAcjB,EAAAA,EAAKE,KAAKgB,QAAVlB,YAAAA,EAAiBS,EAAE,EACtCU,IAAKhB,EACLQ,UAAU,sCACX,EACD,EACD,CACD,CAAA,EAEAE,EAAA,IAACC,EAAO,CAAAC,KAAK,IAAK,CAAA,EAElBL,EAAA,KAAC,MAAI,CAAAC,UAAU,6BACdC,SAAA,CAACC,EAAA,IAAA,MAAA,CAAIF,UAAU,mDACdC,SAAAC,EAAA,IAAC,MAAGF,UAAU,sBAAuBC,WAAgB,CACtD,CAAA,EACAF,EAAA,KAAC,IAAE,CAAAC,UAAU,yCAAyCC,SAAA,CAAA,UAC7CZ,EAAKoB,iBAAA,EACd,EACCZ,EACCK,EAAA,IAAAQ,EAAA,CAAKC,OAAO,UAAUC,OAAO,OAAOZ,UAAU,OAC9CC,SAACC,EAAA,IAAAW,EAAA,CAAOC,KAAK,SAASC,QAAQ,OAAOX,KAAK,OACzCH,SAAAC,EAAA,IAACc,EAAK,CAAAvB,KAAK,OAAOO,UAAU,6BAA6BC,SAAA,SAEzD,EACD,EACD,EACG,KACHC,EAAA,IAAA,MAAA,CAAIF,UAAU,mBACbC,WAECF,EAAA,KAAAkB,WAAA,CAAAhB,SAAA,CAACC,EAAA,IAAAW,EAAA,CAAOK,QAAO,GACdjB,SAACC,EAAA,IAAAiB,EAAA,CAAKC,GAAG,QAAQC,SAAS,SAASpB,SAAA,WAEnC,CACD,CAAA,EACAC,EAAA,IAACW,EAAO,CAAAK,QAAO,GACdjB,SAAAC,EAAA,IAACiB,EAAK,CAAAC,GAAG,oBAAoBC,SAAS,SAASpB,SAAA,eAE/C,CACD,CAAA,CAAA,CACD,CAAA,EAECC,EAAA,IAAAW,EAAA,CAAOK,QAAO,GACdjB,gBAACkB,EAAK,CAAAC,GAAG,QAAQC,SAAS,SACxBpB,SAAA,CAAAT,EAAgB,UAAA,EAClB,EACD,CAEF,CAAA,CAAA,CACD,CAAA,CAAA,CACD,CAAA,CAAA,CACD,CAAA,CAEF,CAEO,MAAM8B,EAAoCA,CAAC,CAAEjC,KAAAA,EAAMkC,OAAAA,CAAO,IAAM,CACtE,MAAMC,GAAcnC,GAAAA,YAAAA,EAAME,KAAKE,OAAQ8B,EAAO7B,SACvC,MAAA,CACN,CAAE+B,MAAO,GAAGD,CAAW,eAAgB,EACvC,CACC/B,KAAM,cACNiC,QAAS,cAAcF,CAAW,gBACnC,CAAA,CAEF,EAEO,SAASG,GAAgB,CAE9B,OAAAzB,EAAAA,IAAC0B,EAAA,CACAC,eAAgB,CACf,IAAK,CAAC,CAAEN,OAAAA,CAAO,WACb,IAAE,CAAAtB,SAAA,CAAA,8BAA4BsB,EAAO7B,SAAS,UAAA,EAAQ,CAEzD,CAAA,CACD,CAEF"}